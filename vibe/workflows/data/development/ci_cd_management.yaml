name: "CI/CD Pipeline Management"
description: "Manage CI/CD pipeline and automate deployment workflows"
triggers:
  - "setup ci cd"
  - "setup github actions"
  - "configure pipeline"
  - "setup continuous integration"
  - "validate ci pipeline"

category: "development"

steps:
  - step_text: "Check if GitHub Actions workflow file exists and is valid"
    command: "Check for YAML workflow files in .github/workflows directory (show first 5 if many exist)"
    working_dir: "."

  - step_text: "Validate YAML syntax of workflow files"
    command: "uv run python -c \"import yaml; [yaml.safe_load(open(f).read()) for f in __import__('pathlib').Path('.github/workflows').glob('*.yml')]\""
    working_dir: "."

  - step_text: "Run the same quality checks that CI will run"
    command: "uv run pre-commit run --all-files && uv run pytest -q --maxfail=1"
    working_dir: "."

  - step_text: "Test MCP server functionality that CI will validate"
    command: "cd mcp-server && npm test --silent && node test.js"
    working_dir: "."

  - step_text: "Test coverage reporting functionality (sample output)"
    command: "uv run pytest -q --maxfail=1 --cov=vibe --cov-report=term | head -40"
    working_dir: "."

  - step_text: "Keep logs concise: prefer quiet reporters, sample long outputs with `head`, and summarize key results briefly."
